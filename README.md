The codes and data for the manuscipt,


"A Computational Mechanism of Cue-Stimulus Integration for Pain in the Brain" 
Codes tested on Ubuntu 20.04, matlab R2021b. 
PEPSI stands for <ins>P</ins>ain <ins>E</ins>xpectation and <ins>P</ins>ain <ins>S</ins>timulus <ins>I</ins>ntegration.

## codes
#### step1_CalcSubspacesEncodingperf.m 
* Implements the processes and visualizations depicted in Figs. 2A-B (Calculation of subspaces and encoding performances).
#### step2_VisTraj.m
* Implements the visualization of the trajectories in subspaces.
#### step3_Traj2Behv.m
* Implements the processes and visualizations depicted in Fig. 5 (Reconstructing behavioral patterns from the neural trajectories).


## data
#### data_for_replication.mat
* Contains all data necessary for implemeting the steps in the codes folder.
#### template.nii
* Provides the brain template for variable "neurAvg" in the data_for_replication.mat.
  
## Dependecies

* SPM12

* https://github.com/cocoanlab/cocoanCORE.git

* https://github.com/canlab/CanlabCore.git

* https://github.com/didch1789/yanchogosu_toolbox.git
